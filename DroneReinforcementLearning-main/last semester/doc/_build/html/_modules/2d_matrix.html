<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2d_matrix &mdash; Drone Reinforcement Learning 1.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Drone Reinforcement Learning
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">code</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Drone Reinforcement Learning</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">2d_matrix</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for 2d_matrix</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;2D_Matrix.ipynb</span>

<span class="sd">Automatically generated by Colaboratory.</span>

<span class="sd">Original file is located at</span>
<span class="sd">    https://colab.research.google.com/drive/1u7PHpb2CAS7DMYpy9sBmvOhdYCzVwZuC</span>

<span class="sd">PLEASE GO THE FOLLOWING LINK TO RUN THE CODE https://colab.research.google.com/drive/1u7PHpb2CAS7DMYpy9sBmvOhdYCzVwZuC?usp=sharing</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;2D_Matrix.ipynb</span>

<span class="sd">Automatically generated by Colaboratory.</span>

<span class="sd">Original file is located at</span>
<span class="sd">    https://colab.research.google.com/drive/1u7PHpb2CAS7DMYpy9sBmvOhdYCzVwZuC</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">These values can be changed to make the reinforcement learning code intersting.</span>

<span class="sd">:params START: This indiccates the start value of the agent/player in the 2d grid.</span>
<span class="sd">:params BOARD_ROWS: This indicates the number of rows in the 2d grid.</span>
<span class="sd">:params BOARD_COLS: This indicates the number of columns in the 2d grid.</span>
<span class="sd">:params WIN_STATE: This indicates the goal of the agent/player to be reached.</span>
<span class="sd">:params Zombie: This indicates the position of the weaker powered obstacle</span>
<span class="sd">:params Wolf: This indicates the position of the stronger powered obstacle</span>
<span class="sd">:params obstacle: All the obstacles are stored in the list for printing it later</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">START</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">BOARD_ROWS</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">BOARD_COLS</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">WIN_STATE</span>  <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">Zombie</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">Wolf</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">obstacle</span> <span class="o">=</span> <span class="p">[</span><span class="n">Zombie</span><span class="p">,</span><span class="n">Wolf</span><span class="p">]</span>

<div class="viewcode-block" id="State"><a class="viewcode-back" href="../2d_matrix.html#2d_matrix.State">[docs]</a><span class="k">class</span> <span class="nc">State</span><span class="p">():</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a State class which controls all the cells state in the 2d grid.</span>
<span class="sd">    In our 2d board depending upon the action by the agent the current state</span>
<span class="sd">    can be changed or it can be a episode (win or lose).</span>

<span class="sd">    :param START: Players start value anywhere in the board</span>
<span class="sd">    :type START: tuple, Mandatory</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="n">START</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor Method</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">board</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">BOARD_ROWS</span><span class="p">,</span> <span class="n">BOARD_COLS</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">state</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">isEnd</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="State.giveReward"><a class="viewcode-back" href="../2d_matrix.html#2d_matrix.State.giveReward">[docs]</a>  <span class="k">def</span> <span class="nf">giveReward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    There are 3 obstacles in the 2d grid, and if any of the state falls under</span>
<span class="sd">    the below mentioned category they get a reward</span>
<span class="sd">    :return: Returns a reward value if it is equal to the any of the mentioned category</span>
<span class="sd">    :rtype: int, this returns only one of the following value 1, -1 and -5   </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">WIN_STATE</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">Zombie</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">Wolf</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="State.isEndFunc"><a class="viewcode-back" href="../2d_matrix.html#2d_matrix.State.isEndFunc">[docs]</a>  <span class="k">def</span> <span class="nf">isEndFunc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is used to stop the reinforcement learning for the current round</span>
<span class="sd">    if it falls under any of the following states WIN_STATE, zombie and wolf</span>
<span class="sd">    :return: Returns a boolean value &quot;True&quot;</span>
<span class="sd">    :rtype: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">WIN_STATE</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">Zombie</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">Wolf</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">isEnd</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="State.nxtPosition"><a class="viewcode-back" href="../2d_matrix.html#2d_matrix.State.nxtPosition">[docs]</a>  <span class="k">def</span> <span class="nf">nxtPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the next position state/cell value based on the agents action and if the next </span>
<span class="sd">    state falls under in any of the teleport dicitonary keys the next state will be not up,</span>
<span class="sd">    down, left and right rather it jumps multiple cells depending upon the dictionary value.</span>
<span class="sd">    Similarly, there is a variabel called pull_back state, which pulls you back to the previous</span>
<span class="sd">    state if your agent action resulted in any of the state present in the pull back list.</span>

<span class="sd">    :param action: Contains any one of the following string value (up, down,left, right)</span>
<span class="sd">    :param type: String</span>
<span class="sd">    :return: Returns the agents tuple value if it not falls under any of the teleport dicitonary or</span>
<span class="sd">    pull back method or else returns the agents desired next state.</span>
<span class="sd">    :rtype: tuple </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">teleport_dictionary</span><span class="o">=</span><span class="p">{(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">):(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">):(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)}</span>
    <span class="n">pull_back</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;up&quot;</span><span class="p">:</span>
        <span class="n">nxtState</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span>
        <span class="n">nxtState</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
        <span class="n">nxtState</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nxtState</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># if next state legal</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">nxtState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nxtState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">BOARD_ROWS</span> <span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">nxtState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nxtState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">BOARD_COLS</span> <span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
          <span class="c1">#Checks if the next state falls in teleport keys</span>
          <span class="k">if</span> <span class="n">nxtState</span> <span class="ow">in</span> <span class="n">teleport_dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">teleport_dictionary</span><span class="p">[(</span><span class="n">nxtState</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">nxtState</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
          <span class="c1"># Checks if the next state is present in the pull back list</span>
          <span class="k">if</span> <span class="n">nxtState</span> <span class="ow">in</span> <span class="n">pull_back</span><span class="p">:</span>
            
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
          <span class="k">return</span> <span class="n">nxtState</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span></div></div>

<div class="viewcode-block" id="Agent"><a class="viewcode-back" href="../2d_matrix.html#2d_matrix.Agent">[docs]</a><span class="k">class</span> <span class="nc">Agent</span><span class="p">():</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This class is responsible for choosing the action until it reaches the episode (Win or Lose). </span>
<span class="sd">  This class depends upon the state class to move to the next state. Depending upon each episode</span>
<span class="sd">  the agent learns and during the next play takes the best action.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor Method</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="bp">self</span><span class="o">.</span><span class="n">states</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">State</span> <span class="o">=</span> <span class="n">State</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lr</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exp_rate</span> <span class="o">=</span> <span class="mf">0.3</span>

    <span class="c1"># initial state reward</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state_values</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">BOARD_ROWS</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">BOARD_COLS</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state_values</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="Agent.chooseAction"><a class="viewcode-back" href="../2d_matrix.html#2d_matrix.Agent.chooseAction">[docs]</a>  <span class="k">def</span> <span class="nf">chooseAction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The agent chooses the action to exploit all the cells and then choose the best possible</span>
<span class="sd">    action or the agent greedy method can be controlled by a exploitation value called </span>
<span class="sd">    exp_rate which is 0.2 everytime. </span>

<span class="sd">    :return: Returns any one of the following value &quot;up&quot;, &quot;down&quot;, &quot;left&quot; or &quot;right&quot; </span>
<span class="sd">    :rtype: String </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># choose action with most expected value</span>
    <span class="n">mx_nxt_reward</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">action</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> 

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_rate</span><span class="p">:</span>
      <span class="n">action</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># greedy action</span>
      <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
          <span class="c1"># if the action is deterministic</span>
        <span class="n">nxt_reward</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_values</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">nxtPosition</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">nxt_reward</span> <span class="o">&gt;=</span> <span class="n">mx_nxt_reward</span><span class="p">:</span>
          <span class="n">action</span> <span class="o">=</span> <span class="n">a</span>
          <span class="n">mx_nxt_reward</span> <span class="o">=</span> <span class="n">nxt_reward</span>
    <span class="k">return</span> <span class="n">action</span></div>

<div class="viewcode-block" id="Agent.takeAction"><a class="viewcode-back" href="../2d_matrix.html#2d_matrix.Agent.takeAction">[docs]</a>  <span class="k">def</span> <span class="nf">takeAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The agent takes the neccessary action (move up,down,left or right) after the action has </span>
<span class="sd">    been chosen from the Class Agent:chooseAction() method.</span>

<span class="sd">    :param action: Contains any one of the following string value (up, down,left, right)</span>
<span class="sd">    :param type: String</span>

<span class="sd">    :return: Updates the state class with new position as the START value</span>
<span class="sd">    :rtype: Returns the state object from (Class: STATE)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">nxtPosition</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">State</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">position</span><span class="p">)</span></div>
<div class="viewcode-block" id="Agent.reset"><a class="viewcode-back" href="../2d_matrix.html#2d_matrix.Agent.reset">[docs]</a>  <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This method resets all the state value and erases the state memory for the entire</span>
<span class="sd">    game played</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">states</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">State</span> <span class="o">=</span> <span class="n">State</span><span class="p">()</span></div>

<div class="viewcode-block" id="Agent.play"><a class="viewcode-back" href="../2d_matrix.html#2d_matrix.Agent.play">[docs]</a>  <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rounds</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This method is responsible for stopping the game if it reaches the episode and then by the </span>
<span class="sd">    help of dictionary the agent backtracks and updates the reward value to all the previous states/cells </span>
<span class="sd">    where it came from using a deterministic reinforcement learning formula called value iteration. By updating</span>
<span class="sd">    the states using reward for each episdode will help the agent to reach its goal or the end state</span>
<span class="sd">    withlin less steps when the game is played next time.</span>

<span class="sd">    :param rounds: Total number of games to be played by the agent</span>
<span class="sd">    :param type: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">rounds</span><span class="p">:</span>

      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">isEnd</span><span class="p">:</span>
        <span class="c1"># back propagate</span>
        <span class="n">reward</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">giveReward</span><span class="p">()</span>
        <span class="c1"># explicitly assign end state to reward values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_values</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="o">=</span> <span class="n">reward</span>  <span class="c1"># this is optional</span>
        <span class="c1">#print(&quot;Game End Reward&quot;, reward)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">):</span>
          <span class="n">reward</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_values</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">lr</span> <span class="o">*</span> <span class="p">(</span><span class="n">reward</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_values</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">state_values</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">reward</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chooseAction</span><span class="p">()</span>
        <span class="c1"># append trace</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">nxtPosition</span><span class="p">(</span><span class="n">action</span><span class="p">))</span>
        <span class="c1">#print(&quot;current position {} action {}&quot;.format(self.State.state, action))</span>
        <span class="c1"># by taking the action, it reaches the next state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">State</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">takeAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
        <span class="c1"># mark is end</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">isEndFunc</span><span class="p">()</span></div>
        <span class="c1">#print(&quot;nxt state&quot;, self.State.state)</span>
        <span class="c1">#print(&quot;---------------------&quot;)</span>
<div class="viewcode-block" id="Agent.showValues"><a class="viewcode-back" href="../2d_matrix.html#2d_matrix.Agent.showValues">[docs]</a>  <span class="k">def</span> <span class="nf">showValues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">BOARD_ROWS</span><span class="p">):</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------------------------------------------------------&#39;</span><span class="p">)</span>
      <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;| &#39;</span>
      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">BOARD_COLS</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">obstacle</span><span class="p">:</span>
          <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39;OBSTACLE&#39;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; | &#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="n">WIN_STATE</span><span class="p">:</span>
          <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39;GOAL&#39;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; | &#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="n">START</span><span class="p">:</span>
          <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39;START&#39;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; | &#39;</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">out</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; | &#39;</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------------------------------------------------------</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">BOARD_ROWS</span><span class="p">):</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------------------------------------------------------&#39;</span><span class="p">)</span>
      <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;| &#39;</span>
      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">BOARD_COLS</span><span class="p">):</span>
          <span class="n">out</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state_values</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; | &#39;</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------------------------------------------------------&#39;</span><span class="p">)</span></div></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  As you can see in the below matrix, the agent start from the position (row:7,column:0) and it reaches the end goal (row:1,column:7) where it gets a </span>
<span class="sd">  reward of 1.0 (mentioned in the second matrix). The agent takes the maximum state values at each step or takes the random action to reduce the exploitation time when the agent starts</span>
<span class="sd">  the game again to play.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">ag</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">()</span>
  <span class="n">ag</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">ag</span><span class="o">.</span><span class="n">showValues</span><span class="p">())</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Ruben McWilliams, Tolu Olatunbosun, Shrinivas Sampath Muthupalaniyappan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>